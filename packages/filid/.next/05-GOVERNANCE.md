# 거버넌스 규칙: 상태 머신 및 위원회 선출

> 원본: BLUE-PRINT.md §4, §9 | 관련: [04-SKILL-INTERFACES.md](./04-SKILL-INTERFACES.md), [08-DEBT-SYSTEM.md](./08-DEBT-SYSTEM.md)

---

## 4. 상태 머신 전이 규칙

### 4.1 상태 정의

```
┌──────────┐     ┌────────┐     ┌──────────────────────┐
│ PROPOSAL │────→│ DEBATE │────→│ VETO / SYNTHESIS /   │
│          │     │        │     │ ABSTAIN              │
└──────────┘     └────────┘     └──────────────────────┘
                      │                    │
                      │     ┌──────────────┤
                      │     │              │
                      ▼     ▼              ▼
                 ┌─────────────┐    ┌───────────┐
                 │ PROPOSAL    │    │ CONCLUSION │
                 │ (재제출)     │    │ (종료)      │
                 └─────────────┘    └───────────┘
```

### 4.2 상태 전이 규칙

| 현재 상태 | 전이 조건 | 다음 상태 | 설명 |
|---|---|---|---|
| **PROPOSAL** | 의장이 코드를 상정 | DEBATE | 기술 검증 결과를 바탕으로 페르소나들이 의견 개진 시작 |
| **DEBATE** | 치명적 결함 발견 (FCA-AI 규칙 초과, 하드코딩 시크릿 등) | VETO | 운영/지식 관리자가 절대적 거부권 행사 |
| **DEBATE** | 합의 도달 (파레토 최적 타협점) | SYNTHESIS | 의장이 타협안을 종합하여 최종 합의안 선언 |
| **DEBATE** | 특정 페르소나의 확신도 임계값 미달 | ABSTAIN | 해당 페르소나가 기권 선언 |
| **VETO** | 발의자가 코드 수정 후 재제출 | PROPOSAL | 수정된 코드로 새 라운드 시작 |
| **VETO** | 비즈니스 드라이버가 CoD 근거 타협안 제시 | DEBATE | 타협 조건 하에 논쟁 재개 |
| **VETO** | 해소 불가능 | CONCLUSION | 리뷰 FAIL로 종료 |
| **SYNTHESIS** | — | CONCLUSION | 합의안 확정, 리뷰 보고서 출력 |
| **ABSTAIN** | 1명 이상 기권 | 아래 정족수 규칙 참조 | 정족수에 따라 CONCLUSION 또는 DEBATE 재진입 |

### 4.3 정족수(Quorum) 규칙

혼합 결과(일부 SYNTHESIS + 일부 ABSTAIN) 처리를 위한 결정론적 규칙:

| 상황 | 판정 | 설명 |
|---|---|---|
| 선출 위원의 ≥ 2/3가 SYNTHESIS | CONCLUSION (APPROVED/REQUEST_CHANGES) | 다수 합의 성립. 기권자는 정족수 분모에서 제외. |
| VETO 1건 이상 발생 | VETO (비즈니스 타협 시도 가능) | 단일 VETO가 SYNTHESIS를 무효화. |
| SYNTHESIS < 2/3, VETO 없음 | CONCLUSION (INCONCLUSIVE) | 합의 미도달, 인간 에스컬레이션 권고. |

**정족수 계산 예시**:
- 위원 4명: SYNTHESIS 3 + ABSTAIN 1 → 유효 위원 3명, SYNTHESIS 3/3 = 100% ≥ 2/3 → **CONCLUSION**
- 위원 6명: SYNTHESIS 3 + ABSTAIN 2 + VETO 1 → VETO 존재 → **VETO**
- 위원 4명: SYNTHESIS 1 + ABSTAIN 3 → 유효 위원 1명, SYNTHESIS 1/1 = 100% ≥ 2/3 → **CONCLUSION** (단, 기권 과반 경고 추가)

### 4.4 상태 추적 형식

의장은 상태 전이를 리뷰 보고서에 명시적으로 기록한다:

```markdown
## 합의 과정 (Deliberation Log)

### Round 1
- **상태**: PROPOSAL
- **상정**: 엔지니어링 아키텍트 — "LCOM4=3, split 필요"
- **전이**: PROPOSAL → DEBATE

### Round 2
- **상태**: DEBATE
- **비즈니스 드라이버**: "split 작업은 2일 소요, CoD=$X. 다음 스프린트로 연기 제안"
- **엔지니어링 아키텍트**: "LCOM4=3은 구조적 결함. 즉시 수정 필수"
- **의장 중재**: "부분 분할 타협안 — 핵심 로직만 분리, 나머지는 부채로 기록"
- **전이**: DEBATE → SYNTHESIS

### Round 3
- **상태**: SYNTHESIS
- **합의안**: "validator 모듈을 tokenValidator + inputValidator로 분할. 나머지 리팩토링은 기술 부채로 발행."
- **전이**: SYNTHESIS → CONCLUSION
```

### 4.5 루프 제한

- 최대 라운드 수: **5회**
- 5회 내 합의 미도달 시: CONCLUSION (INCONCLUSIVE) → 인간 에스컬레이션
- 이유: 무한 루프 방지 + LLM 컨텍스트 절약

---

## 9. 위원회 선출 규칙

### 9.1 복잡도 등급

| 등급 | 조건 | 최소 위원 수 |
|---|---|---|
| **LOW** | 변경 파일 ≤ 3, 단일 프랙탈, 인터페이스 변경 없음 | 2 |
| **MEDIUM** | 변경 파일 4~10, 2~3개 프랙탈, 인터페이스 변경 있음 | 4 |
| **HIGH** | 변경 파일 > 10, 4개+ 프랙탈, 아키텍처 변경 | 6 (전원) |

### 9.2 등급별 필수 선출

| 등급 | 필수 선출 | 선택적 선출 |
|---|---|---|
| LOW | 엔지니어링 아키텍트 + 운영/SRE | — |
| MEDIUM | 엔지니어링 + 지식 관리자 + 비즈니스 드라이버 + 운영/SRE | 프로덕트, 디자인 |
| HIGH | 전원 (6명) | — |

### 9.3 적대적 짝짓기 규칙

| 선출 조건 | 반드시 동시 선출 | 이유 |
|---|---|---|
| 비즈니스 드라이버 선출 | + 지식 관리자 + 운영/SRE | 속도 vs 안정성 견제 |
| 프로덕트 매니저 선출 | + 엔지니어링 아키텍트 | 요구사항 vs 구현 현실 견제 |
| 디자인/HCI 선출 | + 엔지니어링 아키텍트 | 사용성 vs 기술적 제약 견제 |
